@model List<AdminPrivilegeViewModel>
@{
    ViewData["Title"] = "Admin Management";
}

<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1><i class="fas fa-user-shield me-2"></i>Admin Management</h1>
        <div>
            <a href="@Url.Action("Create")" class="btn btn-primary me-2">
                <i class="fas fa-user-plus me-2"></i>Create Admin
            </a>
            <a href="@Url.Action("Applications")" class="btn btn-info me-2">
                <i class="fas fa-clipboard-list me-2"></i>View Applications
            </a>
            <a href="@Url.Action("ExportAdmins", "AdminManagement")" class="btn btn-success">
                <i class="fas fa-file-export me-2"></i>Export Admins
            </a>
            <a href="@Url.Action("ImportAdmins")" class="btn btn-warning">
                <i class="fas fa-file-import me-2"></i>Import
            </a>
        </div>
    </div>

    <div class="card card-modern">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0"><i class="fas fa-users-cog me-2"></i>Administrators</h5>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-modern">
                    <thead>
                        <tr>
                            <th>Admin Name</th>
                            <th>Email</th>
                            <th>Admin Type</th>
                            <th>Permissions</th>
                            <th>Scope</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                        <tr>
                            <th data-orderable="true">Admin Name</th>
                            <th data-orderable="true">Email</th>
                            <th data-orderable="true">Admin Type</th>
                            <th data-orderable="false">Permissions</th>
                            <th data-orderable="true">Scope</th>
                            <th data-orderable="true">Created</th>
                            <th data-orderable="false" data-searchable="false">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var admin in Model)
                        {
                            <tr>
                                <td>@admin.AdminName</td>
                                <td>@admin.Email</td>
                                <td>
                                    <span class="badge
                                            @(admin.AdminType == AdminType.SuperAdmin ? "bg-danger" :
                                                                                    admin.AdminType == AdminType.UniversityAdmin ? "bg-primary" :
                                                                                    admin.AdminType == AdminType.FacultyAdmin ? "bg-info" :
                                                                                    admin.AdminType == AdminType.DepartmentAdmin ? "bg-success" :
                                                                                    admin.AdminType == AdminType.FinanceAdmin ? "bg-warning" : "bg-secondary")">
                                    @admin.AdminTypeName
                                </span>
                            </td>
                            <td>
                                <small>@admin.Permissions.Count permissions</small>
                                <div class="permission-tooltip" data-bs-toggle="tooltip"
                                     title="@string.Join(", ", admin.Permissions)">
                                    <i class="fas fa-info-circle text-muted"></i>
                                </div>
                            </td>
                            <td>
                                @if (!string.IsNullOrEmpty(admin.UniversityScope))
                                    {
                                        <small class="text-muted">Univ: @admin.UniversityScope</small>
                                
                                        <br>
                                    }
                                    @if (!string.IsNullOrEmpty(admin.FacultyScope))
                                    {
                                        <small class="text-muted">Faculty: @admin.FacultyScope</small>
                                
                                        <br>
                                    }
                                    @if (!string.IsNullOrEmpty(admin.DepartmentScope))
                                    {
                                        <small class="text-muted">Dept: @admin.DepartmentScope</small>
                                    }
                                </td>
                                <td>@admin.CreatedDate.ToString("MMM dd, yyyy")</td>
                                <td>
                                    <a href="@Url.Action("EditPrivileges", new { id = admin.AdminId })"
                                       class="btn btn-sm btn-outline-primary">
                                        <i class="fas fa-edit me-1"></i>Edit
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            $('[data-bs-toggle="tooltip"]').tooltip();
        });
        $(document).ready(function() {
            $('#adminsTable').DataTable({
                responsive: true,
                ordering: true,
                pageLength: 25,
                dom: '<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>rt<"row"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',
                language: {
                    search: "_INPUT_",
                    searchPlaceholder: "Search admins..."
                }
            });
        });
    </script>
}