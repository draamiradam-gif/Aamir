@model AdminApplicationViewModel
@{
    ViewData["Title"] = "Review Application";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="fas fa-clipboard-check me-2"></i>Review Application</h5>
                </div>
                <div class="card-body">
                    <!-- Application Details -->
                    <h6>Applicant Information</h6>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <p><strong>Name:</strong> @Model.ApplicantName</p>
                            <p><strong>Email:</strong> @Model.Email</p>
                            <p><strong>Phone:</strong> @Model.Phone</p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Applied For:</strong> <span class="badge bg-info">@Model.AppliedAdminTypeName</span></p>
                            <p><strong>Applied Date:</strong> @Model.AppliedDate.ToString("MMM dd, yyyy")</p>
                            <p><strong>Status:</strong> <span class="badge bg-warning">@Model.Status</span></p>
                        </div>
                    </div>

                    <!-- Scope -->
                    <h6>Requested Scope</h6>
                    <div class="mb-3">
                        @if (!string.IsNullOrEmpty(Model.UniversityName))
                        {
                            <span class="badge bg-primary me-2">University: @Model.UniversityName</span>
                        }
                        @if (!string.IsNullOrEmpty(Model.FacultyName))
                        {
                            <span class="badge bg-info me-2">Faculty: @Model.FacultyName</span>
                        }
                        @if (!string.IsNullOrEmpty(Model.DepartmentName))
                        {
                            <span class="badge bg-success">Department: @Model.DepartmentName</span>
                        }
                    </div>

                    <!-- Justification -->
                    <h6>Justification</h6>
                    <div class="card bg-light mb-3">
                        <div class="card-body">
                            @Model.Justification
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="@Url.Action("Applications")" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-1"></i>Back
                        </a>
                        <div>
                            <button type="button" class="btn btn-success me-2" onclick="approveApplication()">
                                <i class="fas fa-check me-1"></i>Approve
                            </button>
                            <button type="button" class="btn btn-danger" onclick="rejectApplication()">
                                <i class="fas fa-times me-1"></i>Reject
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function approveApplication() {
            var notes = prompt("Enter approval notes (optional):");
            if (notes !== null) {
                $.ajax({
                    url: '@Url.Action("ReviewApplication", "AdminManagement")',
                    type: 'POST',
                    data: {
                        id: @Model.Id,
                        status: 'Approved',
                        reviewNotes: notes
                    },
                    success: function(response) {
                        if (response.success) {
                            alert('Application approved successfully!');
                            window.location.href = '@Url.Action("Applications")';
                        } else {
                            alert('Failed to approve: ' + response.message);
                        }
                    }
                });
            }
        }

        function rejectApplication() {
            var notes = prompt("Enter rejection reason:");
            if (notes !== null) {
                $.ajax({
                    url: '@Url.Action("ReviewApplication", "AdminManagement")',
                    type: 'POST',
                    data: {
                        id: @Model.Id,
                        status: 'Rejected',
                        reviewNotes: notes
                    },
                    success: function(response) {
                        if (response.success) {
                            alert('Application rejected successfully!');
                            window.location.href = '@Url.Action("Applications")';
                        } else {
                            alert('Failed to reject: ' + response.message);
                        }
                    }
                });
            }
        }
    </script>
}